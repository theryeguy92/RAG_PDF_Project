---
- name: "Ensure UFW is installed"
  apt:
    name: ufw
    state: present
    update_cache: yes

- name: "Allow SSH through the firewall"
  ufw:
    rule: allow
    name: OpenSSH

- name: "Allow Kafka ports through the firewall"
  ufw:
    rule: allow
    port: "{{ item }}"
    proto: tcp
  loop:
    - 9092
    - 2181

- name: "Enable UFW"
  ufw:
    state: enabled
    logging: 'on'